import{u as C,j as e,o as _,e as D,s as j,c as b}from"./utils-BFDESJkx.js";import{a as S,C as d,d as u,e as h,b as c,B as t}from"./index-CqREN1s9.js";import{t as I}from"./zod-BP3mTalM.js";import{D as A}from"./dollar-sign-Bp_OTlgP.js";import{U as F}from"./user-5P6zNW4c.js";import{d as U,g as M}from"./hooks-DgF8CINs.js";import{b as B}from"./vendor-DoupW2GI.js";import{A as f}from"./arrow-left-ByMrzti7.js";import{C as P}from"./circle-check-big-D1Wym9_W.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=S("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),$=_({client_id:b.number().min(1,"Please select a client"),amount:b.number().min(.01,"Amount must be greater than $0.01"),currency:j().min(1,"Currency is required").default("USD"),due_date:j().min(1,"Due date is required"),status:D(["draft","pending","paid","overdue","cancelled"]).default("draft")});function E({clients:s,onSubmit:m,isLoading:l=!1,defaultValues:o}){const{register:i,handleSubmit:x,formState:{errors:r,isSubmitting:n},watch:y,reset:v}=C({resolver:I($),defaultValues:{currency:"USD",status:"draft",...o}}),p=y("client_id"),g=y("amount"),N=a=>{const w={client_id:a.client_id,amount_cents:Math.round(a.amount*100),currency:a.currency,due_date:a.due_date,status:a.status};m(w)},k=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a||0);return e.jsxs("form",{onSubmit:x(N),className:"space-y-6",children:[e.jsxs(d,{children:[e.jsx(u,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"Invoice Details"]})}),e.jsxs(c,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"client_id",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.jsx(F,{className:"h-4 w-4 inline mr-1"}),"Client *"]}),e.jsxs("select",{...i("client_id"),id:"client_id",className:`
                block w-full px-3 py-3 border rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors tap-target
                ${r.client_id?"border-error-500 bg-error-50 dark:bg-error-900/20":"border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"}
              `,"aria-invalid":r.client_id?"true":"false","aria-describedby":r.client_id?"client_id-error":void 0,children:[e.jsx("option",{value:"",children:"Select a client..."}),s.map(a=>e.jsxs("option",{value:a.id,children:[a.name," (",a.email,")"]},a.id))]}),r.client_id&&e.jsx("p",{id:"client_id-error",role:"alert",className:"text-sm text-error-600 dark:text-error-400",children:r.client_id.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Amount *"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 text-lg font-medium",children:"$"})}),e.jsx("input",{...i("amount"),type:"number",step:"0.01",min:"0",id:"amount",placeholder:"0.00",className:`
                  block w-full pl-8 pr-3 py-3 border rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors tap-target
                  ${r.amount?"border-error-500 bg-error-50 dark:bg-error-900/20":"border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"}
                `,"aria-invalid":r.amount?"true":"false","aria-describedby":r.amount?"amount-error amount-help":"amount-help"})]}),g>0&&e.jsxs("p",{id:"amount-help",className:"text-sm text-gray-500 dark:text-gray-400",children:["Invoice total: ",k(g)]}),r.amount&&e.jsx("p",{id:"amount-error",role:"alert",className:"text-sm text-error-600 dark:text-error-400",children:r.amount.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Currency"}),e.jsxs("select",{...i("currency"),id:"currency",className:"block w-full px-3 py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors tap-target",children:[e.jsx("option",{value:"USD",children:"USD - US Dollar"}),e.jsx("option",{value:"EUR",children:"EUR - Euro"}),e.jsx("option",{value:"GBP",children:"GBP - British Pound"}),e.jsx("option",{value:"CAD",children:"CAD - Canadian Dollar"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"due_date",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.jsx(T,{className:"h-4 w-4 inline mr-1"}),"Due Date *"]}),e.jsx("input",{...i("due_date"),type:"date",id:"due_date",min:new Date().toISOString().split("T")[0],className:`
                block w-full px-3 py-3 border rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors tap-target
                ${r.due_date?"border-error-500 bg-error-50 dark:bg-error-900/20":"border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"}
              `,"aria-invalid":r.due_date?"true":"false","aria-describedby":r.due_date?"due_date-error":void 0}),r.due_date&&e.jsx("p",{id:"due_date-error",role:"alert",className:"text-sm text-error-600 dark:text-error-400",children:r.due_date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Initial Status"}),e.jsxs("select",{...i("status"),id:"status",className:"block w-full px-3 py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors tap-target",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"pending",children:"Pending"})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Draft invoices can be edited later. Pending invoices are ready to send."})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:justify-end",children:[e.jsx(t,{type:"button",variant:"ghost",onClick:()=>v(),disabled:n||l,children:"Reset Form"}),e.jsx(t,{type:"submit",disabled:n||l,className:"order-first sm:order-none",children:n||l?"Creating...":"Create Invoice"})]}),p&&e.jsx(d,{className:"bg-primary-50 dark:bg-primary-900/20 border-primary-200 dark:border-primary-800",children:e.jsx(c,{className:"pt-4",children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"font-medium text-primary-700 dark:text-primary-300",children:["Invoice will be created for:"," "]}),e.jsx("span",{className:"text-primary-600 dark:text-primary-400",children:s.find(a=>a.id===Number(p))?.name})]})})})]})}function Q(){const s=B(),{data:m,isLoading:l}=U({limit:100,offset:0}),o=M(),i=m?.data||[],x=async r=>{try{const n=await o.mutateAsync(r);s(`/invoices/${n.id}`)}catch(n){console.error("Failed to create invoice:",n)}};return l?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"loading-shimmer h-10 w-10 rounded"}),e.jsxs("div",{children:[e.jsx("div",{className:"loading-shimmer h-8 w-48 mb-2"}),e.jsx("div",{className:"loading-shimmer h-4 w-64"})]})]}),e.jsx("div",{className:"loading-shimmer h-96 w-full rounded-lg"})]}):i.length===0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(t,{variant:"ghost",size:"sm",onClick:()=>s("/invoices"),className:"p-2",children:e.jsx(f,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Create New Invoice"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Create a new invoice for your client"})]})]}),e.jsx(d,{children:e.jsxs(c,{className:"text-center py-12",children:[e.jsx("div",{className:"text-warning-400 mb-4",children:e.jsx(P,{className:"h-16 w-16 mx-auto"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No Clients Yet"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"You need to create at least one client before you can create an invoice."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(t,{onClick:()=>s("/clients/new"),children:"Create Your First Client"}),e.jsx("br",{}),e.jsx(t,{variant:"ghost",onClick:()=>s("/clients"),children:"View Clients"})]})]})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(t,{variant:"ghost",size:"sm",onClick:()=>s("/invoices"),className:"p-2","aria-label":"Back to invoices",children:e.jsx(f,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Create New Invoice"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Create a new invoice for your client"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(E,{clients:i,onSubmit:x,isLoading:o.isPending})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(d,{children:[e.jsx(u,{children:e.jsx(h,{children:"Quick Actions"})}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(t,{variant:"ghost",className:"w-full justify-start",onClick:()=>s("/clients/new"),children:"Add New Client"}),e.jsx(t,{variant:"ghost",className:"w-full justify-start",onClick:()=>s("/clients"),children:"Manage Clients"}),e.jsx(t,{variant:"ghost",className:"w-full justify-start",onClick:()=>s("/invoices"),children:"View All Invoices"}),e.jsx(t,{variant:"ghost",className:"w-full justify-start",onClick:()=>s("/dashboard"),children:"Back to Dashboard"})]})})]}),e.jsxs(d,{className:"bg-primary-50 dark:bg-primary-900/20 border-primary-200 dark:border-primary-800",children:[e.jsx(u,{children:e.jsx(h,{className:"text-primary-700 dark:text-primary-300",children:"Tips"})}),e.jsx(c,{children:e.jsxs("div",{className:"text-sm space-y-2 text-primary-600 dark:text-primary-400",children:[e.jsx("p",{children:"• Set due dates 30 days from today for best results"}),e.jsx("p",{children:'• Use "Draft" status if you need to review before sending'}),e.jsx("p",{children:"• All amounts are processed securely"})]})})]})]})]})]})}export{Q as InvoiceCreateView};
