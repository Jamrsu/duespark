import{j as e}from"./utils-BFDESJkx.js";import{b as W,R as i}from"./vendor-DoupW2GI.js";import{a as c,C as k,b as w,B as n,d as P,e as I,X as F,H as A,g as H,f as X}from"./index-CqREN1s9.js";import{S as Q}from"./StatusBadge-BMt1r0ga.js";import{c as Y,d as ee}from"./hooks-DgF8CINs.js";import{P as M}from"./plus-itcZ0HEe.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=c("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=c("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=c("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=c("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=c("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function me(){const j=W(),[r,l]=i.useState({client_id:"",status:"",date_from:"",date_to:"",sortBy:"date_newest"}),[m,b]=i.useState(!1),[z,x]=i.useState(!1),[h,u]=i.useState(""),[g,_]=i.useState([]),[f,p]=i.useState(null),[C,L]=i.useState(!1);i.useEffect(()=>{const t=localStorage.getItem("invoiceFilterPresets"),s=localStorage.getItem("invoiceDefaultPresetId");if(t)try{const a=JSON.parse(t);if(_(a),s){p(s);const v=a.find(U=>U.id===s);v&&!C&&(l(v.filters),L(!0))}}catch(a){console.error("Error loading saved presets:",a)}},[C]);const T=i.useMemo(()=>{const t={limit:100,offset:0};return r.client_id&&(t.client_id=parseInt(r.client_id)),r.status&&(t.status=r.status),r.date_from&&(t.date_from=r.date_from),r.date_to&&(t.date_to=r.date_to),t},[r.client_id,r.status,r.date_from,r.date_to]),{data:O,isLoading:V}=Y(T),{data:$}=ee({limit:100,offset:0}),S=O?.data||[],o=$?.data||[],E=i.useMemo(()=>[...o].sort((t,s)=>t.name.localeCompare(s.name)),[o]),d=t=>t.client?.name?t.client.name:o.find(a=>a.id===t.client_id)?.name||`Client #${t.client_id}`,N=i.useMemo(()=>{const t=[...S];switch(r.sortBy){case"amount_high_to_low":return t.sort((s,a)=>a.amount_cents-s.amount_cents);case"amount_low_to_high":return t.sort((s,a)=>s.amount_cents-a.amount_cents);case"date_newest":return t.sort((s,a)=>new Date(a.due_date).getTime()-new Date(s.due_date).getTime());case"date_oldest":return t.sort((s,a)=>new Date(s.due_date).getTime()-new Date(a.due_date).getTime());case"invoice_high_to_low":return t.sort((s,a)=>a.id-s.id);case"invoice_low_to_high":return t.sort((s,a)=>s.id-a.id);case"company_a_to_z":return t.sort((s,a)=>d(s).localeCompare(d(a)));case"company_z_to_a":return t.sort((s,a)=>d(a).localeCompare(d(s)));default:return t}},[S,r.sortBy,o]),J=()=>{l({client_id:"",status:"",date_from:"",date_to:"",sortBy:"date_newest"})},y=r.client_id!==""||r.status!==""||r.date_from!==""||r.date_to!=="",D=()=>{if(!h.trim())return;const t={id:Date.now().toString(),name:h.trim(),filters:{...r},createdAt:new Date().toISOString()},s=[...g,t];_(s),localStorage.setItem("invoiceFilterPresets",JSON.stringify(s)),u(""),x(!1)},R=t=>{l(t.filters),m||b(!0)},Z=t=>{const s=g.filter(a=>a.id!==t);_(s),localStorage.setItem("invoiceFilterPresets",JSON.stringify(s)),f===t&&(p(null),localStorage.removeItem("invoiceDefaultPresetId"))},q=t=>{p(t),localStorage.setItem("invoiceDefaultPresetId",t)},G=()=>{p(null),localStorage.removeItem("invoiceDefaultPresetId")},K=t=>{const s=[];if(t.filters.client_id){const a=o.find(v=>v.id.toString()===t.filters.client_id);s.push(a?.name||`Client #${t.filters.client_id}`)}return t.filters.status&&s.push(t.filters.status.charAt(0).toUpperCase()+t.filters.status.slice(1)),t.filters.date_from&&s.push(`From: ${t.filters.date_from}`),t.filters.date_to&&s.push(`To: ${t.filters.date_to}`),s.length>0?s.join(" • "):"Custom filter"};return V?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"loading-shimmer h-8 w-32"}),e.jsx("div",{className:"loading-shimmer h-10 w-32"})]}),e.jsx(k,{children:e.jsx(w,{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((t,s)=>e.jsx("div",{className:"loading-shimmer h-16 rounded-lg"},s))})})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Invoices"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Manage your invoices and track payments"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{variant:m?"secondary":"ghost",onClick:()=>b(!m),className:"w-full sm:w-auto",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Filters",y&&e.jsx("span",{className:"ml-2 bg-primary-500 text-white rounded-full w-2 h-2"})]}),e.jsxs(n,{className:"w-full sm:w-auto",onClick:()=>j("/invoices/new"),children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"New Invoice"]})]})]}),m&&e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"Filter Invoices"]}),e.jsx("div",{className:"flex gap-2",children:y&&e.jsxs(e.Fragment,{children:[e.jsxs(n,{variant:"ghost",size:"sm",onClick:()=>x(!0),className:"text-sm",children:[e.jsx(se,{className:"h-4 w-4 mr-1"}),"Save"]}),e.jsxs(n,{variant:"ghost",size:"sm",onClick:J,className:"text-sm",children:[e.jsx(F,{className:"h-4 w-4 mr-1"}),"Clear All"]})]})})]})}),e.jsxs(w,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Client"}),e.jsxs("select",{value:r.client_id,onChange:t=>l(s=>({...s,client_id:t.target.value})),className:"input",children:[e.jsx("option",{value:"",children:"All Clients"}),E.map(t=>e.jsx("option",{value:t.id.toString(),children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{value:r.status,onChange:t=>l(s=>({...s,status:t.target.value})),className:"input",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"overdue",children:"Overdue"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"From Date"}),e.jsx("input",{type:"date",value:r.date_from,onChange:t=>l(s=>({...s,date_from:t.target.value})),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"To Date"}),e.jsx("input",{type:"date",value:r.date_to,onChange:t=>l(s=>({...s,date_to:t.target.value})),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort By"}),e.jsxs("select",{value:r.sortBy,onChange:t=>l(s=>({...s,sortBy:t.target.value})),className:"input",children:[e.jsx("option",{value:"date_newest",children:"Date (Newest to Oldest)"}),e.jsx("option",{value:"date_oldest",children:"Date (Oldest to Newest)"}),e.jsx("option",{value:"amount_high_to_low",children:"Amount (High to Low)"}),e.jsx("option",{value:"amount_low_to_high",children:"Amount (Low to High)"}),e.jsx("option",{value:"invoice_high_to_low",children:"Invoice # (High to Low)"}),e.jsx("option",{value:"invoice_low_to_high",children:"Invoice # (Low to High)"}),e.jsx("option",{value:"company_a_to_z",children:"Company (A-Z)"}),e.jsx("option",{value:"company_z_to_a",children:"Company (Z-A)"})]})]})]}),g.length>0&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),"Saved Filter Presets"]}),f&&e.jsxs("button",{onClick:G,className:"text-xs text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 flex items-center gap-1",title:"Clear default preset",children:[e.jsx(F,{className:"h-3 w-3"}),"Clear Default"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:g.map(t=>{const s=f===t.id;return e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg border ${s?"bg-primary-50 dark:bg-primary-900/20 border-primary-200 dark:border-primary-800":"bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-600"}`,children:[s&&e.jsx(A,{className:"h-3 w-3 text-primary-600 dark:text-primary-400","aria-label":"Default preset"}),e.jsx("button",{onClick:()=>R(t),className:`text-sm font-medium ${s?"text-primary-700 dark:text-primary-300 hover:text-primary-800 dark:hover:text-primary-200":"text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400"}`,title:K(t),children:t.name}),e.jsxs("div",{className:"flex items-center gap-1 ml-1",children:[!s&&e.jsx("button",{onClick:()=>q(t.id),className:"text-gray-400 hover:text-primary-500 p-1",title:"Set as startup default",children:e.jsx(A,{className:"h-3 w-3"})}),e.jsx("button",{onClick:()=>Z(t.id),className:"text-gray-400 hover:text-red-500 p-1",title:"Delete preset",children:e.jsx(re,{className:"h-3 w-3"})})]})]},t.id)})}),f&&e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 flex items-center gap-1",children:[e.jsx(te,{className:"h-3 w-3"}),"Default preset will be applied automatically when you visit this page"]})]}),z&&e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"bg-primary-50 dark:bg-primary-900/20 p-4 rounded-lg border border-primary-200 dark:border-primary-800",children:[e.jsx("h4",{className:"text-sm font-medium text-primary-900 dark:text-primary-100 mb-3",children:"Save Current Filter Combination"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:h,onChange:t=>u(t.target.value),placeholder:"Enter preset name...",className:"input flex-1",onKeyDown:t=>{t.key==="Enter"?D():t.key==="Escape"&&(x(!1),u(""))},autoFocus:!0}),e.jsx(n,{onClick:D,disabled:!h.trim(),size:"sm",children:"Save"}),e.jsx(n,{variant:"ghost",onClick:()=>{x(!1),u("")},size:"sm",children:"Cancel"})]})]})})]})]}),e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(I,{children:[y?"Filtered":"All"," Invoices (",N.length,")",y&&e.jsx("span",{className:"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400",children:"- filters applied"})]})}),e.jsx(w,{children:N.length>0?e.jsx("div",{className:"space-y-4",children:N.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg cursor-pointer transition-colors",onClick:()=>j(`/invoices/${t.id}`),children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("h3",{className:"font-medium text-gray-900 dark:text-gray-100",children:["Invoice #",t.id]}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["• ",d(t)]}),e.jsx(Q,{status:t.status})]}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Due: ",H(t.due_date)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:X(t.amount_cents,t.currency)}),t.paid_at&&e.jsxs("div",{className:"text-xs text-success-600 dark:text-success-400",children:["Paid ",H(t.paid_at)]})]})]},t.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx("svg",{className:"h-16 w-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No invoices yet"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Get started by creating your first invoice."}),e.jsxs(n,{onClick:()=>j("/invoices/new"),children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Create Invoice"]})]})})]})]})}export{me as InvoicesView};
